(this.webpackJsonpaccess_management_memo=this.webpackJsonpaccess_management_memo||[]).push([[0],{315:function(e,t,n){},346:function(e,t){},348:function(e,t){},362:function(e,t){},364:function(e,t){},392:function(e,t){},394:function(e,t){},395:function(e,t){},400:function(e,t){},402:function(e,t){},408:function(e,t){},410:function(e,t){},429:function(e,t){},441:function(e,t){},444:function(e,t){},480:function(e,t,n){},651:function(e,t,n){},653:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(60),i=n.n(o),c=n(186),s=n(17),l=n(28),u=n.n(l),d=n(180),b=n.n(d),p=n(316),m=n.n(p),h=n(317),f=n(64),w=n.n(f),j=function(e){var t=e.username,n=e.password;return w()({url:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DOC_TITLE:"Document title"}).REACT_APP_API_ENDPOINT,"/auth/login"),method:"POST",headers:{"Context-Type":"application/json"},data:{username:t,password:n}}).then((function(e){return e.data})).catch((function(e){throw e}))},O=function(e){var t=e.token;return w()({url:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DOC_TITLE:"Document title"}).REACT_APP_API_ENDPOINT,"/auth/permission"),method:"GET",headers:{"Context-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){return e.data})).catch((function(e){throw e}))},g=function(e){var t=e.token;return w()({url:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DOC_TITLE:"Document title"}).REACT_APP_API_ENDPOINT,"/thing/all"),method:"GET",headers:{"Context-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){return e.data})).catch((function(e){throw e}))},v=n(179),y=v.AbilityBuilder,x=v.Ability;var k=n(7),_=Object(a.createContext)({user:[],permission:[],getPermission:function(){},userLogin:function(){}}),T=function(e){var t=e.children,n=e.ability,r=Object(a.useState)(null),o=Object(s.a)(r,2),i=o[0],c=o[1],l=Object(a.useState)(null),d=Object(s.a)(l,2),b=d[0],p=d[1];function m(e){if(console.log("getPermission"),u.a.get("access_token")){O({token:u.a.get("access_token")}).then((function(e){p(e);var t=function(e){var t=new y(x),n=t.rules,a=t.can;return t.cannot,e.map((function(e,t){var n=e.split(":");a(n[0],n[1])})),n}(e);n.update(t)})).catch((function(e){alert("Get permission is went wrong. Plese try again.")}))}else alert("Please login")}return Object(k.jsx)(_.Provider,{value:{user:i,permission:b,getPermission:m,userLogin:function(e){var t=e.username,n=e.password;j({username:t,password:n}).then((function(e){var t=e.accessToken;e.refreshToken;u.a.set("access_token",t),c(Object(h.a)(t)),m()})).catch((function(e){console.log("login error",e),c(null),u.a.remove("access_token")}))}},children:t})},S=n(125),C=[{key:"name",label:"Name",permission:"read:thing",fixed:!0,width:70},{key:"uid",label:"UID",permission:"read:uid",fixed:!0,width:70},{key:"cctv",label:"CCTV",permission:"read:cctv",fixed:!0,width:70},{key:"alarm",label:"Alarm",permission:"read:alarm",fixed:!0,width:70}],E=[{key:"edit_thing",label:"Edit Thing",permission:"update:thing",fixed:!0,width:70},{key:"edit_alarm",label:"Edit  Alarm",permission:"update:alarm",checkPackage:!0,fixed:!0,width:70}],P=n(111),A=Object(a.createContext)(),D=(Object(P.a)(A.Consumer),n(128)),R=n(33),N=n(659),z=n(660),H=n(49),I=(n(479),n(480),["rowData","dataKey"]),F=["key","label"],L=["key","label"],K=function(e){return Object(k.jsx)(N.a.Cell,Object(R.a)(Object(R.a)({},e),{},{style:{padding:4}}))},U=function(e){return Object(k.jsx)(N.a.HeaderCell,Object(R.a)(Object(R.a)({},e),{},{style:{padding:4,backgroundColor:"#3498ff",color:"#fff"}}))};var W=function(e){var t=e.tcolumn,n=e.tvalue,o=e.action,i=e.loading,c=n,l=r.a.useState(!0),u=Object(s.a)(l,2),d=u[0],b=(u[1],r.a.useState(!0)),p=Object(s.a)(b,2),m=p[0],h=(p[1],r.a.useState(!1)),f=Object(s.a)(h,2),w=f[0],j=(f[1],r.a.useState(!0)),O=Object(s.a)(j,2),g=O[0],v=(O[1],r.a.useState(!0)),y=Object(s.a)(v,2),x=y[0],_=(y[1],r.a.useState(!0)),T=Object(s.a)(_,2),S=T[0],C=(T[1],r.a.useState(t.map((function(e){return e.key})))),E=Object(s.a)(C,2),P=E[0],A=(E[1],t.filter((function(e){return P.some((function(t){return t===e.key}))}))),W=d?K:N.a.Cell,B=d?U:N.a.HeaderCell,M=function(e){var t=e.rowData,n=e.dataKey,a=Object(D.a)(e,I);function r(){alert("Name : ".concat(t[n]))}return Object(k.jsx)(N.a.Cell,Object(R.a)(Object(R.a)({},a),{},{className:"link-group",children:a.checkPackage?"advanced"===t.package?Object(k.jsx)(z.a,{appearance:"subtle",onClick:r,icon:Object(k.jsx)(H.a,{icon:"pencil"})}):"-":Object(k.jsx)(z.a,{appearance:"subtle",onClick:r,icon:Object(k.jsx)(H.a,{icon:"pencil"})})}))};return Object(k.jsx)("div",{children:Object(k.jsxs)(N.a,{loading:i,height:500,hover:S,showHeader:g,autoHeight:x,data:w?[]:c,bordered:m,cellBordered:m,headerHeight:d?80:90,rowHeight:d?80:96,affixHorizontalScrollbar:!0,width:"80vw",children:[A.map((function(e){var t=e.key,n=e.label,r=Object(D.a)(e,F);return Object(a.createElement)(N.a.Column,Object(R.a)(Object(R.a)({},r),{},{key:t,width:160,align:"center"}),Object(k.jsx)(B,{children:n}),Object(k.jsx)(W,{dataKey:t}))})),o.map((function(e){var t=e.key,n=e.label,r=Object(D.a)(e,L);return Object(a.createElement)(N.a.Column,Object(R.a)(Object(R.a)({},r),{},{key:t,width:160,align:"center"}),Object(k.jsx)(B,{children:n}),Object(k.jsx)(M,{dataKey:"name",action:!0}))}))]})})},B=Object(a.createContext)({dataTable:[],getDataTable:function(){}}),M=function(e){var t=e.children,n=(e.ability,Object(a.useState)(null)),r=Object(s.a)(n,2),o=r[0],i=r[1];return Object(k.jsx)(B.Provider,{value:{dataTable:o,getDataTable:function(){g({token:u.a.get("access_token")}).then((function(e){i(e)})).catch((function(e){alert("Get data table is went wrong. Plese try again.")}))}},children:t})};var V=function(){var e=Object(a.useContext)(_),t=Object(a.useContext)(B),n=Object(P.b)(A),o=u.a.get("access_token"),i=Object(a.useState)(!1),l=Object(s.a)(i,2),d=l[0],p=l[1],h=Object(a.useState)([]),f=Object(s.a)(h,2),w=f[0],j=f[1],O=Object(a.useState)([]),g=Object(s.a)(O,2),v=g[0],y=g[1],x=Object(a.useState)(!0),T=Object(s.a)(x,2),D=T[0],R=T[1];return Object(a.useMemo)((function(){u.a.get("access_token")&&e.getPermission()}),[]),Object(S.useEffect)((function(){R(!0),t.getDataTable(),p(function(e){var t;try{console.log("verify try"),t=m.a.verify(e,Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DOC_TITLE:"Document title"}).REACT_APP_SECRET)}catch(n){console.log("verify catch",n),t=!1}return t}(o))}),[e.user]),Object(S.useEffect)((function(){R(!1)}),[t.dataTable]),Object(S.useEffect)((function(){!function(e){var t=Object(c.a)(C),a=b.a.remove(t,(function(e,t){var a=e.permission.split(":");return n.can(a[0],a[1])})),r=Object(c.a)(E),o=b.a.remove(r,(function(e,t){var a=e.permission.split(":");return n.can(a[0],a[1])}));y(o),j(a)}()}),[e.permission]),!1!==d?Object(k.jsx)(r.a.Fragment,{children:Object(k.jsx)("main",{className:"h-100 flex items-center justify-center",children:Object(k.jsx)("div",{className:"flex flex-column h-100 w-auto mh{8}",style:{height:"calc(100vh - {8}5px - {8}rem)",width:"calc(100vw - {8}5px - {8}rem)"},children:Object(k.jsx)(W,{tcolumn:w,tvalue:t.dataTable?t.dataTable:[],action:v,loading:D})})})}):Object(k.jsx)(k.Fragment,{children:Object(k.jsx)("div",{className:"flex justify-center text-2xl mt-96",style:{marginTop:"10rem"},children:"Not Permission"})})},G=[{id:1,username:"a",display:"User A",password:"P@ssw0rd"},{id:2,username:"c",display:"User C",password:"P@ssw0rd"}];var Y=function(){var e=Object(a.useContext)(_);return Object(k.jsx)("header",{className:"header",children:Object(k.jsx)("ul",{className:"roles",children:G.map((function(t,n){return Object(k.jsx)(r.a.Fragment,{children:Object(k.jsx)("li",{children:Object(k.jsx)("button",{type:"button",name:t.username,onClick:function(){return e.userLogin({username:t.username,password:t.password})},children:t.display})})})}))})})},X=n(179);n(651),n(315);var J,q,Q=function(e){var t=new X.Ability;return Object(k.jsx)(k.Fragment,{children:Object(k.jsx)(A.Provider,{value:t,children:Object(k.jsxs)(T,{ability:t,children:[Object(k.jsx)(Y,{}),Object(k.jsx)(M,{children:Object(k.jsx)(V,{ability:t})})]})})})},Z=n(184),$=n(120),ee=Object($.a)(J||(J=Object(Z.a)(['*, ::before, ::after {\nbox-sizing: border-box;\nborder-width: 0;\nborder-style: solid;\n--tw-border-opacity: 1;\nborder-color: rgba(229, 231, 235, var(--tw-border-opacity));\n--tw-translate-x: 0;\n--tw-translate-y: 0;\n--tw-rotate: 0;\n--tw-skew-x: 0;\n--tw-skew-y: 0;\n--tw-scale-x: 1;\n--tw-scale-y: 1;\n--tw-transform: translateX(var(--tw-translate-x)) translateY(var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n--tw-ring-inset: var(--tw-empty,/*!*/ /*!*/);\n--tw-ring-offset-width: 0px;\n--tw-ring-offset-color: #fff;\n--tw-ring-color: rgba(59, 130, 246, 0.5);\n--tw-ring-offset-shadow: 0 0 #0000;\n--tw-ring-shadow: 0 0 #0000;\n--tw-shadow: 0 0 #0000;\n--tw-blur: var(--tw-empty,/*!*/ /*!*/);\n--tw-brightness: var(--tw-empty,/*!*/ /*!*/);\n--tw-contrast: var(--tw-empty,/*!*/ /*!*/);\n--tw-grayscale: var(--tw-empty,/*!*/ /*!*/);\n--tw-hue-rotate: var(--tw-empty,/*!*/ /*!*/);\n--tw-invert: var(--tw-empty,/*!*/ /*!*/);\n--tw-saturate: var(--tw-empty,/*!*/ /*!*/);\n--tw-sepia: var(--tw-empty,/*!*/ /*!*/);\n--tw-drop-shadow: var(--tw-empty,/*!*/ /*!*/);\n--tw-filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n--tw-backdrop-blur: var(--tw-empty,/*!*/ /*!*/);\n--tw-backdrop-brightness: var(--tw-empty,/*!*/ /*!*/);\n--tw-backdrop-contrast: var(--tw-empty,/*!*/ /*!*/);\n--tw-backdrop-grayscale: var(--tw-empty,/*!*/ /*!*/);\n--tw-backdrop-hue-rotate: var(--tw-empty,/*!*/ /*!*/);\n--tw-backdrop-invert: var(--tw-empty,/*!*/ /*!*/);\n--tw-backdrop-opacity: var(--tw-empty,/*!*/ /*!*/);\n--tw-backdrop-saturate: var(--tw-empty,/*!*/ /*!*/);\n--tw-backdrop-sepia: var(--tw-empty,/*!*/ /*!*/);\n--tw-backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);\n        }\nhtml {\nline-height: 1.5;\n-webkit-text-size-adjust: 100%;\n-moz-tab-size: 4;\ntab-size: 4;\nfont-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";\n        }\nbody {\nmargin: 0;\nfont-family: inherit;\nline-height: inherit;\n        }\nhr {\nheight: 0;\ncolor: inherit;\nborder-top-width: 1px;\n        }\nabbr[title] {\ntext-decoration: underline dotted;\n        }\nb, strong {\nfont-weight: bolder;\n        }\ncode, kbd, samp, pre {\nfont-family: ui-monospace, SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, monospace;\nfont-size: 1em;\n        }\nsmall {\nfont-size: 80%;\n        }\nsub, sup {\nfont-size: 75%;\nline-height: 0;\nposition: relative;\nvertical-align: baseline;\n        }\nsub {\nbottom: -0.25em;\n        }\nsup {\ntop: -0.5em;\n        }\ntable {\ntext-indent: 0;\nborder-color: inherit;\nborder-collapse: collapse;\n        }\nbutton, input, optgroup, select, textarea {\nfont-family: inherit;\nfont-size: 100%;\nline-height: inherit;\nmargin: 0;\npadding: 0;\ncolor: inherit;\n        }\nbutton, select {\ntext-transform: none;\n        }\nbutton, [type=\'button\'], [type=\'reset\'], [type=\'submit\'] {\n-webkit-appearance: button;\n        }\n::-moz-focus-inner {\nborder-style: none;\npadding: 0;\n        }\n:-moz-focusring {\noutline: 1px dotted ButtonText;\n        }\n:-moz-ui-invalid {\nbox-shadow: none;\n        }\nlegend {\npadding: 0;\n        }\nprogress {\nvertical-align: baseline;\n        }\n::-webkit-inner-spin-button, ::-webkit-outer-spin-button {\nheight: auto;\n        }\n[type=\'search\'] {\n-webkit-appearance: textfield;\noutline-offset: -2px;\n        }\n::-webkit-search-decoration {\n-webkit-appearance: none;\n        }\n::-webkit-file-upload-button {\n-webkit-appearance: button;\nfont: inherit;\n        }\nsummary {\ndisplay: list-item;\n        }\nblockquote, dl, dd, h1, h2, h3, h4, h5, h6, hr, figure, p, pre {\nmargin: 0;\n        }\nbutton {\nbackground-color: transparent;\nbackground-image: none;\n        }\nfieldset {\nmargin: 0;\npadding: 0;\n        }\nol, ul {\nlist-style: none;\nmargin: 0;\npadding: 0;\n        }\nimg {\nborder-style: solid;\n        }\ntextarea {\nresize: vertical;\n        }\ninput::placeholder, textarea::placeholder {\ncolor: #9ca3af;\n        }\nbutton, [role="button"] {\ncursor: pointer;\n        }\nh1, h2, h3, h4, h5, h6 {\nfont-size: inherit;\nfont-weight: inherit;\n        }\na {\ncolor: inherit;\ntext-decoration: inherit;\n        }\npre, code, kbd, samp {\nfont-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;\n        }\nimg, svg, video, canvas, audio, iframe, embed, object {\ndisplay: block;\nvertical-align: middle;\n        }\nimg, video {\nmax-width: 100%;\nheight: auto;\n        }\n[hidden] {\ndisplay: none;\n        }\n@keyframes spin {\nto {\ntransform: rotate(360deg);\n        }\n        }\n@keyframes ping {\n75%, 100% {\ntransform: scale(2);\nopacity: 0;\n        }\n        }\n@keyframes pulse {\n50% {\nopacity: .5;\n        }\n        }\n@keyframes bounce {\n0%, 100% {\ntransform: translateY(-25%);\nanimation-timing-function: cubic-bezier(0.8,0,1,1);\n        }\n50% {\ntransform: none;\nanimation-timing-function: cubic-bezier(0,0,0.2,1);\n        }\n        }']))),te=Object($.a)(q||(q=Object(Z.a)(["\n  body {\n    -webkit-tap-highlight-color: ",";\n    ","\n  }\n  \n"])),"#f3f4f6",{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"}),ne=function(){return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(ee,{}),Object(k.jsx)(te,{})]})};i.a.render(Object(k.jsxs)(r.a.StrictMode,{children:[Object(k.jsx)(ne,{}),Object(k.jsx)(Q,{})]}),document.getElementById("root"))}},[[653,1,2]]]);
//# sourceMappingURL=main.f3919fec.chunk.js.map